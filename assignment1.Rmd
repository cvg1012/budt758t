---
title: "R Notebook"
output:
  html_notebook: default
  word_document: default
  pdf_document:
    latex_engine: xelatex
always_allow_html: yes
---

```{r setup, include=FALSE}

# This chunk shows/hides the code in your final report. When echo = TRUE, the code
# is shown in the report. When echo = FALSE, the code is hidden from the final report.
# We would like to see your code, so please leave the setting as is during the course.
# This chunk will not show up in your reports, so you can safely ignore its existence.

knitr::opts_chunk$set(echo = TRUE)

```


The following is your first chunk to start with. Remember, you can add chunks using the menu
above (Insert -> R) or using the keyboard shortcut Ctrl+Alt+I. A good practice is to use
different code chunks to answer different questions. You can delete this comment if you like.

Other useful keyboard shortcuts include Alt- for the assignment operator, and Ctrl+Shift+M
for the pipe operator. You can delete these reminders if you don't want them in your report.


```{r}
setwd("C:/Users/cvg10/Desktop/DMPA") #Don't forget to set your working directory before you start!

library("tidyverse")
library("tidymodels")
library("plotly")
library("skimr")
library("gapminder")
library("ggrepel")


``` 

```{r}
dfGap <- gapminder

```
Q3) a)

```{r}
skim(dfGap)
```

Q3) b)
```{r}
df2007<-
  dfGap %>% 
    filter(year==2007) %>% 
    arrange(desc(lifeExp))
```

b)i)
```{r}
df2007 %>% 
  filter(lifeExp>81) %>% 
  select(country)
```
The countries are Japan, Hong Kong(China), Iceland, Switzerland, Australia

Q3) c)
```{r}
dfGdp<-
  df2007 %>% 
    mutate(totalGDP=pop*gdpPercap) %>% 
    arrange(desc(totalGDP))

dfGdp
```
*Considering only the top 5 countries in the following questions*

i)United States, China, Japan, India, Germany

ii)Japan, Hong Kong - China

iii)

```{r}

dfGdp %>% 
  select(country, gdpPercap) %>% 
  arrange(desc(gdpPercap))

```
Overlapped countries: United States
This shows that United states has the highest GDP along with the highest life expectancy.


Q3) d)

```{r}
dfGdp %>% 
  group_by(continent) %>% 
  summarize(medLe= median(lifeExp), medGdp=median(totalGDP)) %>% 
  ungroup() %>% 
  arrange(desc(medLe))
```

i)  The Oceania continent seems to have the highest life expectancy. 
ii) The median life exp. and median totalGDP dont seem to be coorelated to each other due to Americas.



Q4)
a)
```{r}

dfGdp %>% 
  filter(year==2007) %>% 
  ggplot(aes(x=totalGDP, y=lifeExp))+geom_point()
```
This plot shows us that most of the countries are clustered together and some outliers exist.

```{r}
plot <- 
  dfGdp %>% 
    filter(year==2007,totalGDP > 1e+12) %>% 
    ggplot(aes(x=totalGDP, y=lifeExp))+geom_point()
plot
```
When we filter out countries with GDP greater than 1 trillion we still see a small cluster along with some outliers.

```{r}
plot+geom_label(aes(label=country))
```

The countries out of the cluster are USA, China, India, Brazil 


```{r}
plot+geom_label_repel(aes(label=country))
```
Yes, it does look better now. The labels dont overlap the points anymore and the points in the clusters have arrows to indicate their corresponding labels.

```{r}
dfGdp %>% 
  filter(year==2007, totalGDP>1e+12) %>% 
  ggplot(aes(x=totalGDP, y=lifeExp, fill=factor(continent)))+ geom_point()+ geom_label_repel(aes(label=country))

```
The Oceania continent and the African continent are missing from the graph now and they are missing due to the filters applied.


4)b)

```{r}
dfGdp %>% 
  filter(year==2007) %>% 
  ggplot(aes(x=gdpPercap, y=lifeExp))+geom_point()+geom_smooth()

```
We see that the points are clustered along the regression line itself and a few outliers exist now.Apart from that, we see a sharp rise followed by a smooth curve as the GDP oer cap goes above 10,000.


4)c)

```{r}
dfGdp %>% 
  ggplot(aes(y=lifeExp, color=factor(continent))) +geom_boxplot()+labs(title="Box Plots for all continents")
```

i) Oceania
ii)Africa
iii)Medians:
    Africa:52.93
    Americas: 72.9
    Asia=72.4
    Europe: 78.61
    Oceania: 80.72
    

```{r}
boxPlotsForAll <- 
  dfGdp %>% 
    ggplot(aes(y=lifeExp, color=factor(continent))) +geom_boxplot()+labs(title="Box Plots for all continents")

ggplotly(boxPlotsForAll)
```

Q4)d

```{r}
dfGap %>% 
  group_by(year,continent) %>% 
  mutate(mdnGPC=median(gdpPercap)) %>% 
  ungroup() %>% 
  ggplot(aes(x=year,y=mdnGPC, color=factor(continent)))+geom_point()+geom_line()
```
i)The Oceania and rhe Europe continent have a clearer trend as compared to others because theyb show an increasing trend.

ii)

```{r}
gdpOverTime <- 
  dfGap %>% 
    group_by(year,continent) %>% 
    mutate(mdnGPC=mean(gdpPercap)) %>% 
    ungroup() %>% 
    ggplot(aes(x=year,y=mdnGPC, color=factor(continent)))+geom_point()+geom_line()
gdpOverTime
```
The trend line of the the Asian continet has changed drastically when the metric was changed from median to mean. The change is observed kdue to the calculations.

iii)
The oceania  and the Europe continent shows a steady increasing trend, the Asian and the American continent show a pretty flat trend growth while the african continent hardly grows.

```{r}
ggplotly(gdpOverTime)
```
